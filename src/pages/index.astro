---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllGames } from '../lib/games';

const games = getAllGames();
const tickerText = games.map(g => `${g.title} — ${g.comparable}`).join('  ·  ') + '  ·  ';
---

<BaseLayout>
  <!-- ===== HERO ===== -->
  <section class="relative h-screen flex flex-col justify-end px-6 md:px-10 pb-[12vh] overflow-hidden">
    <!-- Big ambient gradient -->
    <div class="absolute inset-0 bg-[radial-gradient(ellipse_80%_50%_at_50%_-20%,rgba(100,60,180,0.12),transparent)]"></div>

    <div class="relative">
      <p
        class="font-[family-name:var(--font-label)] text-[10px] md:text-[11px] tracking-[0.35em] uppercase text-[var(--color-smoke)] mb-6 hero-label"
        style="opacity:0;"
      >
        A game design studio
      </p>

      <h1 class="hero-title" style="opacity:0;">
        <span class="block font-[family-name:var(--font-headline)] text-[12vw] md:text-[8vw] lg:text-[6.5vw] font-900 leading-[0.85] tracking-[-0.03em] text-[var(--color-cream)]">
          Parallax
        </span>
        <span class="block font-[family-name:var(--font-headline)] text-[12vw] md:text-[8vw] lg:text-[6.5vw] font-900 leading-[0.85] tracking-[-0.03em] italic text-[var(--color-smoke)]">
          Studios
        </span>
      </h1>

      <div class="mt-10 flex items-end gap-8 md:gap-16 hero-stats" style="opacity:0;">
        <div>
          <span class="font-[family-name:var(--font-headline)] text-[3rem] md:text-[4rem] font-700 leading-none text-[var(--color-chalk)]">14</span>
          <p class="font-[family-name:var(--font-label)] text-[9px] tracking-[0.3em] uppercase text-[var(--color-smoke)] mt-1">Games</p>
        </div>
        <div>
          <span class="font-[family-name:var(--font-headline)] text-[3rem] md:text-[4rem] font-700 leading-none text-[var(--color-chalk)]">14</span>
          <p class="font-[family-name:var(--font-label)] text-[9px] tracking-[0.3em] uppercase text-[var(--color-smoke)] mt-1">Industries</p>
        </div>
        <p class="font-[family-name:var(--font-body)] text-[var(--color-fog)] text-base md:text-lg italic max-w-xs leading-relaxed hidden md:block">
          Every angle.
        </p>
      </div>
    </div>

    <!-- Scroll hint -->
    <div class="absolute bottom-6 right-6 md:right-10 flex items-center gap-2 hero-hint" style="opacity:0;">
      <span class="font-[family-name:var(--font-label)] text-[9px] tracking-[0.3em] uppercase text-[var(--color-ash)]">Scroll</span>
      <span class="block w-px h-6 bg-[var(--color-ash)]"></span>
    </div>
  </section>

  <!-- ===== TICKER ===== -->
  <div class="border-y border-[var(--color-ash)]/40 py-4 ticker-wrap">
    <div class="ticker-content">
      <span class="font-[family-name:var(--font-label)] text-[10px] tracking-[0.2em] uppercase text-[var(--color-smoke)]">
        {tickerText}{tickerText}
      </span>
    </div>
  </div>

  <!-- ===== CHANNEL STRIP — HORIZONTAL SCROLL ===== -->
  <section class="relative">
    <div class="px-6 md:px-10 pt-20 pb-8 flex items-baseline justify-between">
      <h2 class="font-[family-name:var(--font-headline)] text-3xl md:text-4xl italic text-[var(--color-chalk)]">
        The Games
      </h2>
      <span class="font-[family-name:var(--font-label)] text-[10px] tracking-[0.25em] uppercase text-[var(--color-ash)] hidden md:block">
        Scroll horizontally &rarr;
      </span>
    </div>

    <div class="channel-strip">
      {games.map((game, i) => (
        <a href={`/games/${game.slug}`} class="channel-card group" style={`--ch-accent: ${game.accent};`}>
          <!-- Colored gradient background -->
          <div
            class="channel-card__bg"
            style={`background: radial-gradient(ellipse at 30% 20%, ${game.accent} 0%, transparent 60%), radial-gradient(ellipse at 80% 80%, ${game.accent}44 0%, transparent 50%);`}
          ></div>

          <div class="channel-card__content w-full">
            <!-- Number -->
            <span
              class="block font-[family-name:var(--font-label)] text-[10px] tracking-[0.35em] uppercase mb-3"
              style={`color: ${game.accent};`}
            >
              {game.number} / 14
            </span>

            <!-- Title -->
            <h3
              class="font-[family-name:var(--font-headline)] text-4xl md:text-5xl font-900 leading-[0.9] tracking-tight text-[var(--color-cream)] mb-4"
              transition:name={`game-title-${game.slug}`}
            >
              {game.title}
            </h3>

            <!-- Comparable -->
            <p class="font-[family-name:var(--font-ui)] text-sm font-500 mb-3" style={`color: ${game.accent};`}>
              {game.comparable}
            </p>

            <!-- Elevator -->
            <p class="font-[family-name:var(--font-body)] text-sm text-[var(--color-fog)] leading-relaxed line-clamp-3 max-w-sm">
              {game.elevator}
            </p>

            <!-- Industry tag -->
            <div class="mt-5 flex items-center gap-3">
              <span class="font-[family-name:var(--font-label)] text-[9px] tracking-[0.25em] uppercase text-[var(--color-smoke)]">
                {game.industry}
              </span>
              <span class="flex-1 h-px bg-[var(--color-ash)]/40"></span>
              <span class="font-[family-name:var(--font-label)] text-[9px] tracking-[0.2em] uppercase text-[var(--color-ash)] group-hover:text-[var(--color-fog)] transition-colors">
                Read &rarr;
              </span>
            </div>
          </div>
        </a>
      ))}
    </div>
  </section>

  <!-- ===== ABOUT TEASER ===== -->
  <section class="px-6 md:px-10 py-32">
    <div class="max-w-3xl">
      <p class="font-[family-name:var(--font-label)] text-[10px] tracking-[0.35em] uppercase text-[var(--color-smoke)] mb-8">
        The Studio
      </p>
      <h2 class="font-[family-name:var(--font-headline)] text-3xl md:text-5xl lg:text-6xl font-700 leading-[1.05] tracking-tight text-[var(--color-cream)] mb-8">
        We don't chase genres.<br/>
        We chase <em class="italic text-[var(--color-fog)]">industries</em>&mdash;<br/>
        and find the game hiding<br/>
        inside each one.
      </h2>
      <div class="flex items-center gap-6">
        <a
          href="/studio"
          class="font-[family-name:var(--font-label)] text-[11px] tracking-[0.2em] uppercase text-[var(--color-chalk)] border-b border-[var(--color-chalk)] pb-0.5 hover:text-[var(--color-fog)] hover:border-[var(--color-fog)] transition-colors"
        >
          Meet the team
        </a>
        <a
          href="/games"
          class="font-[family-name:var(--font-label)] text-[11px] tracking-[0.2em] uppercase text-[var(--color-smoke)] border-b border-[var(--color-smoke)] pb-0.5 hover:text-[var(--color-chalk)] hover:border-[var(--color-chalk)] transition-colors"
        >
          Browse all 14
        </a>
      </div>
    </div>
  </section>

  <script>
    import { gsap } from 'gsap';
    import { ScrollTrigger } from 'gsap/ScrollTrigger';
    gsap.registerPlugin(ScrollTrigger);

    // Hero stagger
    gsap.to('.hero-label', { opacity: 1, y: 0, duration: 0.8, delay: 0.2, ease: 'power3.out' });
    gsap.fromTo('.hero-title', { opacity: 0, y: 60 }, { opacity: 1, y: 0, duration: 1.2, delay: 0.4, ease: 'power3.out' });
    gsap.to('.hero-stats', { opacity: 1, y: 0, duration: 0.8, delay: 0.9, ease: 'power3.out' });
    gsap.to('.hero-hint', { opacity: 1, duration: 0.6, delay: 1.4 });

    // Channel cards parallax on scroll
    document.querySelectorAll('.channel-card').forEach((card) => {
      const bg = card.querySelector('.channel-card__bg') as HTMLElement;
      if (bg) {
        gsap.fromTo(bg,
          { y: -30 },
          {
            y: 30,
            ease: 'none',
            scrollTrigger: {
              trigger: card,
              scroller: card.parentElement,
              horizontal: true,
              start: 'left right',
              end: 'right left',
              scrub: true,
            }
          }
        );
      }
    });
  </script>
</BaseLayout>
